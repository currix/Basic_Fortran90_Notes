<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0//EN">

<html>

<head>

<meta http-equiv="content-type" content="text/html; charset=iso-8859-1">

<title>Fortran 90 Lessons for Computational Chemistry - Introduction to Fortran Arrays</title>

<link href="index.html" rel="start">
<link href="ch-clase_2.html" rel="prev">
<link href="ch-clase_4.html" rel="next">
<link href="index.html#contents" rel="contents">
<link href="index.html#copyright" rel="copyright">
<link href="ch-clase_1.html" rel="chapter" title="1 Introduction">
<link href="ch-clase_2.html" rel="chapter" title="2 Basic Operations">
<link href="ch-clase_3.html" rel="chapter" title="3 Introduction to Fortran Arrays">
<link href="ch-clase_4.html" rel="chapter" title="4 More on Arrays">
<link href="ch-clase_7.html" rel="chapter" title="5 Control Structures">
<link href="ch-clase_5.html" rel="chapter" title="6 INPUT/OUTPUT (I)">
<link href="ch-clase_6.html" rel="chapter" title="7 Input/Output (II)">
<link href="ch-clase_8.html" rel="chapter" title="8 Subprograms (I): FUNCTIONS">
<link href="ch-clase_9.html" rel="chapter" title="9 Subprogramas (II): subrutinas">
<link href="ch-clase_10.html" rel="chapter" title="10 Subprogramas (III): módulos">
<link href="ch-clase_11.html" rel="chapter" title="11 Subprogramas (IV)">
<link href="ch-clase_blaslap.html" rel="chapter" title="12 Instalación y uso de las bibliotecas BLAS y LAPACK">
<link href="ch-cap_ref.html" rel="chapter" title="13 Referencias">
<link href="ch-clase_1.html#s-sec_11" rel="section" title="1.1 Objectives">
<link href="ch-clase_1.html#s-sec_12" rel="section" title="1.2 Main items.">
<link href="ch-clase_1.html#s-sec_13" rel="section" title="1.3 Example Codes.">
<link href="ch-clase_2.html#s-sec_21" rel="section" title="2.1 Objectives">
<link href="ch-clase_2.html#s-sec_22" rel="section" title="2.2 Main items.">
<link href="ch-clase_2.html#s-sec_23" rel="section" title="2.3 Example Codes.">
<link href="ch-clase_3.html#s-sec_31" rel="section" title="3.1 Objectivos">
<link href="ch-clase_3.html#s-sec_32" rel="section" title="3.2 Main items.">
<link href="ch-clase_3.html#s-sec_33" rel="section" title="3.3 Example Codes.">
<link href="ch-clase_4.html#s-sec_41" rel="section" title="4.1 Objectives">
<link href="ch-clase_4.html#s-sec_42" rel="section" title="4.2 Main items.">
<link href="ch-clase_4.html#s-sec_43" rel="section" title="4.3 Example Codes.">
<link href="ch-clase_7.html#s-sec_71" rel="section" title="5.1 Objectives">
<link href="ch-clase_7.html#s-sec_72" rel="section" title="5.2 Main items.">
<link href="ch-clase_7.html#s-sec_73" rel="section" title="5.3 Example codes.">
<link href="ch-clase_5.html#s-sec_51" rel="section" title="6.1 Objectivos">
<link href="ch-clase_5.html#s-sec_52" rel="section" title="6.2 Main Items.">
<link href="ch-clase_5.html#s-sec_53" rel="section" title="6.3 Example Codes">
<link href="ch-clase_6.html#s-sec_61" rel="section" title="7.1 Objectives">
<link href="ch-clase_6.html#s-sec_62" rel="section" title="7.2 Main items.">
<link href="ch-clase_6.html#s-sec_63" rel="section" title="7.3 Example Codes">
<link href="ch-clase_8.html#s-sec_81" rel="section" title="8.1 Objectives">
<link href="ch-clase_8.html#s-sec_82" rel="section" title="8.2 Main items.">
<link href="ch-clase_8.html#s-sec_83" rel="section" title="8.3 Example Codes">
<link href="ch-clase_9.html#s-sec_91" rel="section" title="9.1 Objetivos">
<link href="ch-clase_9.html#s-sec_92" rel="section" title="9.2 Puntos destacables.">
<link href="ch-clase_9.html#s-sec_93" rel="section" title="9.3 Programas usados como ejemplo.">
<link href="ch-clase_10.html#s-sec_101" rel="section" title="10.1 Objetivos">
<link href="ch-clase_10.html#s-sec_102" rel="section" title="10.2 Puntos destacables.">
<link href="ch-clase_10.html#s-sec_103" rel="section" title="10.3 Programas usados como ejemplo.">
<link href="ch-clase_11.html#s-sec_111" rel="section" title="11.1 Objetivos">
<link href="ch-clase_11.html#s-sec_112" rel="section" title="11.2 Puntos destacables.">
<link href="ch-clase_11.html#s-sec_113" rel="section" title="11.3 Programas usados como ejemplo.">
<link href="ch-clase_blaslap.html#s-sec_bl1" rel="section" title="12.1 Objetivos">
<link href="ch-clase_blaslap.html#s-sec_bl2" rel="section" title="12.2 Puntos destacables.">
<link href="ch-clase_blaslap.html#s-sec_bl3" rel="section" title="12.3 Programas usados como ejemplo.">
<link href="ch-clase_1.html#s-sec_p_1_1" rel="subsection" title="1.3.1 excode_1_1.f90">
<link href="ch-clase_1.html#s-sec_p_1_2" rel="subsection" title="1.3.2 excode_1_2.f90">
<link href="ch-clase_2.html#s-sec_p_2_1" rel="subsection" title="2.3.1 excode_2_1.f90">
<link href="ch-clase_2.html#s-sec_p_2_2" rel="subsection" title="2.3.2 excode_2_2.f90">
<link href="ch-clase_2.html#s-sec_p_2_3" rel="subsection" title="2.3.3 excode_2_3.f90">
<link href="ch-clase_2.html#s-sec_p_2_4" rel="subsection" title="2.3.4 excode_2_4.f90">
<link href="ch-clase_2.html#s-sec_p_2_5" rel="subsection" title="2.3.5 excode_2_5.f90">
<link href="ch-clase_2.html#s-sec_p_2_6" rel="subsection" title="2.3.6 excode_2_6.f90">
<link href="ch-clase_3.html#s-sec_p_3_1" rel="subsection" title="3.3.1 excode_3_1.f90">
<link href="ch-clase_3.html#s-sec_p_3_2" rel="subsection" title="3.3.2 excode_3_2.f90">
<link href="ch-clase_3.html#s-sec_p_3_3" rel="subsection" title="3.3.3 excode_3_3.f90">
<link href="ch-clase_3.html#s-sec_p_3_4" rel="subsection" title="3.3.4 excode_3_4.f90">
<link href="ch-clase_4.html#s-sec_p_4_1" rel="subsection" title="4.3.1 excode_4_1.f90">
<link href="ch-clase_4.html#s-sec_p_4_2" rel="subsection" title="4.3.2 excode_4_2.f90">
<link href="ch-clase_4.html#s-sec_p_4_3" rel="subsection" title="4.3.3 excode_4_3.f90">
<link href="ch-clase_4.html#s-sec_p_4_4" rel="subsection" title="4.3.4 excode_4_4.f90">
<link href="ch-clase_4.html#s-sec_p_4_5" rel="subsection" title="4.3.5 excode_4_5.f90">
<link href="ch-clase_4.html#s-sec_p_4_6" rel="subsection" title="4.3.6 excode_4_6.f90">
<link href="ch-clase_7.html#s-sec_p_7_1" rel="subsection" title="5.3.1 excode_5_1.f90">
<link href="ch-clase_7.html#s-sec_p_7_2" rel="subsection" title="5.3.2 excode_5_2.f90">
<link href="ch-clase_7.html#s-sec_p_7_3" rel="subsection" title="5.3.3 excode_5_3.f90">
<link href="ch-clase_7.html#s-sec_p_7_4" rel="subsection" title="5.3.4 Programa ejemplo_5_4.f90">
<link href="ch-clase_5.html#s-sec_p_5_1" rel="subsection" title="6.3.1 excode_6_1.f90">
<link href="ch-clase_5.html#s-sec_p_5_2" rel="subsection" title="6.3.2 excode_6_2.f90">
<link href="ch-clase_5.html#s-sec_p_5_3" rel="subsection" title="6.3.3 excode_6_3.f90">
<link href="ch-clase_5.html#s-sec_p_5_4" rel="subsection" title="6.3.4 excode_6_4.f90">
<link href="ch-clase_5.html#s-sec_p_5_5" rel="subsection" title="6.3.5 excode_6_5.f90">
<link href="ch-clase_5.html#s-sec_p_5_6" rel="subsection" title="6.3.6 excode_6_6.f90">
<link href="ch-clase_5.html#s-sec_p_5_7" rel="subsection" title="6.3.7 excode_6_7.f90">
<link href="ch-clase_6.html#s-sec_p_6_1" rel="subsection" title="7.3.1 Programa ejemplo_7_1.f90">
<link href="ch-clase_6.html#s-sec_p_6_2" rel="subsection" title="7.3.2 excode_7_2.f90">
<link href="ch-clase_6.html#s-sec_p_6_22" rel="subsection" title="7.3.3 Script ej_here_file">
<link href="ch-clase_6.html#s-sec_p_6_3" rel="subsection" title="7.3.4 excode_7_3.f90">
<link href="ch-clase_6.html#s-sec_p_6_32" rel="subsection" title="7.3.5 namelist input file">
<link href="ch-clase_6.html#s-sec_p_6_4" rel="subsection" title="7.3.6 excode_7_4.f90">
<link href="ch-clase_8.html#s-sec_p_8_1" rel="subsection" title="8.3.1 excode_8_1.f90">
<link href="ch-clase_8.html#s-sec_p_8_2" rel="subsection" title="8.3.2 excode_8_2.f90">
<link href="ch-clase_8.html#s-sec_p_8_3" rel="subsection" title="8.3.3 Programa ejemplo_8_3.f90">
<link href="ch-clase_8.html#s-sec_p_8_4" rel="subsection" title="8.3.4 Programa ejemplo_8_4.f90">
<link href="ch-clase_8.html#s-sec_p_8_5" rel="subsection" title="8.3.5 excode_8_5.f90">
<link href="ch-clase_8.html#s-sec_p_8_6" rel="subsection" title="8.3.6 excode_8_6.f90">
<link href="ch-clase_8.html#s-sec_p_8_7" rel="subsection" title="8.3.7 excode_8_7.f90">
<link href="ch-clase_9.html#s-sec_p_9_1" rel="subsection" title="9.3.1 Programa ejemplo_9_1.f90">
<link href="ch-clase_9.html#s-sec_p_9_2" rel="subsection" title="9.3.2 Programa ejemplo_9_2.f90">
<link href="ch-clase_9.html#s-sec_p_9_3" rel="subsection" title="9.3.3 Programa ejemplo_9_3.f90">
<link href="ch-clase_9.html#s-sec_p_9_4" rel="subsection" title="9.3.4 Programa ejemplo_9_4.f90">
<link href="ch-clase_9.html#s-sec_p_9_5" rel="subsection" title="9.3.5 Programa ejemplo_9_5.f90">
<link href="ch-clase_9.html#s-sec_p_9_6" rel="subsection" title="9.3.6 Programa ejemplo_9_6.f90">
<link href="ch-clase_9.html#s-sec_p_9_7" rel="subsection" title="9.3.7 Programa ejemplo_9_7.f90">
<link href="ch-clase_10.html#s-sec_p_10_1" rel="subsection" title="10.3.1 Programa ejemplo_10_1.f90">
<link href="ch-clase_10.html#s-sec_p_10_2" rel="subsection" title="10.3.2 Programa ejemplo_10_2.f90">
<link href="ch-clase_10.html#s-sec_p_10_3" rel="subsection" title="10.3.3 Programa ejemplo_10_3.f90">
<link href="ch-clase_10.html#s-sec_p_10_4" rel="subsection" title="10.3.4 Programa ejemplo_10_4.f90">
<link href="ch-clase_11.html#s-sec_p_11_1" rel="subsection" title="11.3.1 Programa ejemplo_11_1.f90">
<link href="ch-clase_11.html#s-sec_p_11_2" rel="subsection" title="11.3.2 Programa ejemplo_11_2.f90">
<link href="ch-clase_11.html#s-sec_p_11_3" rel="subsection" title="11.3.3 Programa ejemplo_11_3.f90">
<link href="ch-clase_11.html#s-sec_p_11_4" rel="subsection" title="11.3.4 Programa ejemplo_11_4.f90">
<link href="ch-clase_blaslap.html#s-sec_p_bl_1" rel="subsection" title="12.3.1 Ejemplo de fichero make.inc para LAPACK">
<link href="ch-clase_blaslap.html#s-sec_p_bl_2" rel="subsection" title="12.3.2 Ejemplo de fichero make.inc para LAPACK95">
<link href="ch-clase_blaslap.html#s-sec_p_bl_3" rel="subsection" title="12.3.3 Ejemplo de programa que invoca LAPACK95">
<link href="ch-clase_blaslap.html#s-sec_p_bl_4" rel="subsection" title="12.3.4 Ejemplo de makefile para compilar programas que invocan LAPACK95">

</head>

<body>

<p><a name="ch-clase_3"></a></p>
<hr>

<p>
[ <a href="ch-clase_2.html">previous</a> ]
[ <a href="index.html#contents">Contents</a> ]
[ <a href="ch-clase_1.html">1</a> ]
[ <a href="ch-clase_2.html">2</a> ]
[ 3 ]
[ <a href="ch-clase_4.html">4</a> ]
[ <a href="ch-clase_7.html">5</a> ]
[ <a href="ch-clase_5.html">6</a> ]
[ <a href="ch-clase_6.html">7</a> ]
[ <a href="ch-clase_8.html">8</a> ]
[ <a href="ch-clase_9.html">9</a> ]
[ <a href="ch-clase_10.html">10</a> ]
[ <a href="ch-clase_11.html">11</a> ]
[ <a href="ch-clase_blaslap.html">12</a> ]
[ <a href="ch-cap_ref.html">13</a> ]
[ <a href="ch-clase_4.html">next</a> ]
</p>

<hr>

<h1>
<code>Fortran 90</code> Lessons for Computational Chemistry
<br>Chapter 3 - Introduction to <code>Fortran</code> Arrays
</h1>

<hr>

<h2 id="s-sec_31">3.1 Objectivos</h2>

<p>
The main aims of this session are the following
</p>
<ol type="1" start="1" >
<li>
<p>
present one dimension arrays as <code>Fortran</code> data structures.
</p>
</li>
</ol>
<ol type="1" start="2" >
<li>
<p>
present the different ways of defining an array.
</p>
</li>
</ol>
<ol type="1" start="3" >
<li>
<p>
present the <samp>DO</samp> loop syntax and the implicit <samp>DO</samp> and
their use with matrices.
</p>
</li>
</ol>
<ol type="1" start="4" >
<li>
<p>
explore dynamic arrays in <code>Fortran 90</code>
</p>
</li>
</ol>
<ol type="1" start="5" >
<li>
<p>
present multidimensional arrays as <code>Fortran</code> data structures.
</p>
</li>
</ol>

<hr>

<h2 id="s-sec_32">3.2 Main items.</h2>

<p>
Basic Definitions:
</p>
<ol type="1" start="1" >
<li>
<p>
<em>rank</em>: number of indices necessary to indicate unambiguously an array
element.
</p>
</li>
</ol>
<ol type="1" start="2" >
<li>
<p>
<em>bounds</em>: max and min values of the indices labelling array elements in
each dimension.
</p>
</li>
</ol>
<ol type="1" start="3" >
<li>
<p>
<em>extent</em>: number of elements in an array dimension.
</p>
</li>
</ol>
<ol type="1" start="4" >
<li>
<p>
<em>size</em>: total number of a matrix.
</p>
</li>
</ol>
<ol type="1" start="5" >
<li>
<p>
<em>conformal</em>: two arrays are conformal if both have the same rank and
extent.
</p>
</li>
</ol>

<p>
The following points should be emphasized:
</p>
<ul>
<li>
<p>
one dimensional array (vector) definition making use of the <samp>DO</samp>
control structure (see <a href="#s-sec_p_3_1"><samp>excode_3_1.f90</samp>,
Section 3.3.1</a> and exercise 2_1)
</p>
</li>
</ul>
<ul>
<li>
<p>
use of the <samp>PARAMETER</samp> declaration for the definition of array
bounds in static array declaration.
</p>
</li>
</ul>
<ul>
<li>
<p>
initialize before use.  Beware of surprises.  The initialization to a common
constant value is extremely simple: <samp>vec = <var>valor</var></samp>.  A
possible alternative is the use of <em>array constructors</em>.  In the
following example, in order to define an integer array with six elements called
<samp>vec_int</samp> three possible and equivalent options are given
</p>

<pre>
     do i = 0, 5
        vec_int(i) = 2*i
     enddo
     
     vec_int = (/(2*i, i = 0, 5)/)
     
     vec_int = (/0,2,4,6,8,10/)
</pre>

<p>
Last two options involve <em>array constructors</em> and can be carried out
when the array is declared[<a href="footnotes.html#f4" name="fr4">4</a>]
</p>
</li>
</ul>
<ul>
<li>
<p>
use of the <samp>ALLOCATABLE</samp> declaration and the use of the
<samp>ALLOCATE</samp> function, as it is shown in example <a
href="#s-sec_p_3_2"><samp>excode_3_2.f90</samp>, Section 3.3.2</a>.  The
<samp>ALLOCATE</samp> option <samp>STAT = <var>var</var></samp> allows to chek
if the array has been properly defined.  See example in program <a
href="ch-clase_9.html#s-sec_p_9_3">Programa ejemplo_9_3.f90, Section 9.3.3</a>.
</p>
</li>
</ul>
<ul>
<li>
<p>
implicit <samp>DO</samp> and multidimensional arrays.  See example <a
href="#s-sec_p_3_3"><samp>excode_3_3.f90</samp>, Section 3.3.3</a>.
</p>
</li>
</ul>
<ul>
<li>
<p>
most general form of the <samp>DO</samp> control structure and possibility of
introducing zero or negative array indeces.  See example <a
href="#s-sec_p_3_4"><samp>excode_3_4.f90</samp>, Section 3.3.4</a>.
</p>
</li>
</ul>
<ul>
<li>
<p>
combination of <code>bash</code> redirectioning with <code>Fortran</code>
programs.  Necessary for exercise 2, it is explained in <a
href="ch-clase_4.html">More on Arrays, Chapter 4</a>.
</p>
</li>
</ul>

<hr>

<h2 id="s-sec_33">3.3 Example Codes.</h2>

<hr>

<h3 id="s-sec_p_3_1">3.3.1 <samp>excode_3_1.f90</samp></h3>

<pre>
     PROGRAM ex_3_1
     !
     ! VARIABLES DEFINITION 
       IMPLICIT NONE
       REAL :: Total=0.0, Average=0.0
       INTEGER, PARAMETER :: Week=7
       REAL , DIMENSION(1:semana) :: Lab_Hours
       INTEGER :: Day
     !
       PRINT *,' Labor Time (hours per day during a week):'
       DO Day= 1, Week
          READ *, Lab_Hours(Day)
       ENDDO
     !
       DO Day = 1, Week
          Total = Total + Lab_Hours(Day)
       ENDDO
       Average = Total / Week
     !
       PRINT *,' Average Weekly Workload: '
       PRINT *, Average, ' hours'
     END PROGRAM ex_3_1
</pre>

<hr>

<h3 id="s-sec_p_3_2">3.3.2 <samp>excode_3_2.f90</samp></h3>

<pre>
     PROGRAM ex_3_2
       !
       ! VARIABLE DEFINITION
       IMPLICIT NONE
       REAL :: Total=0.0, Average=0.0
       REAL , DIMENSION(:), ALLOCATABLE :: Lab_Hours
       INTEGER :: Day, Number_Days
       !
       PRINT *,' Number of workdays:'
       READ *, Number_Days
       !
       ALLOCATE(Lab_Hours(1:Number_Days))
       !
       PRINT *,' Daily hours of work in ', Number_Days, ' days.'
       DO Day = 1, Number_Days
          READ *, Lab_Hours(Day)
       ENDDO
       !
       DO Day=1, Number_Days
          Total = Total + Lab_Hours(Day)
       ENDDO
       Average = Total / Number_Days
     !
       PRINT *,' Average daily workhours in ',Number_Days, ' days : '
       PRINT *, Average, ' hours'
     !
     END PROGRAM ex_3_2
</pre>

<hr>

<h3 id="s-sec_p_3_3">3.3.3 <samp>excode_3_3.f90</samp></h3>

<pre>
     PROGRAM ATTEND_CONTROL
       IMPLICIT NONE
       INTEGER , PARAMETER :: N_students = 3
       INTEGER , PARAMETER :: N_courses = 3
       INTEGER , PARAMETER :: N_lab = 3
       INTEGER :: student, course, lab
       CHARACTER*2 , DIMENSION(1:N_lab,1:N_courses,1:N_lab) :: attend = 'NO'
       DO student = 1, N_students
          DO course = 1,N_courses
             READ *,(attend(lab,course,student),lab = 1, N_lab)
          ENDDO
       ENDDO
       PRINT *,' Lab attendance : '
       DO student=1, N_students
          PRINT *,' Student = ', student
          DO course = 1,N_courses
             PRINT *,'   Course = ', course, ' : ', (attend(lab,course,student),lab=1,N_lab)
          ENDDO
       ENDDO
     END PROGRAM ATTEND_CONTROL
</pre>

<hr>

<h3 id="s-sec_p_3_4">3.3.4 <samp>excode_3_4.f90</samp></h3>

<pre>
     PROGRAM ex_3_4
       IMPLICIT NONE
       REAL , DIMENSION(-180:180) :: Time=0
       INTEGER :: Degree, Strip
       REAL :: Value
     !
       DO Degree=-165,165,15
          Value=Degree/15
          DO Strip=-7,7
             Time(Degree+Strip)=Value
          ENDDO
       ENDDO
     !
       DO Strip=0,7
          Time(-180 + Strip) = -180/15
          Time( 180 - Strip) = 180/15
       ENDDO
     !
       DO Degree=-180,180
          PRINT *,Degree,' ',Time(Degree), 12 + Time(Degree)
       END DO
     END PROGRAM ex_3_4
</pre>

<hr>

<p>
[ <a href="ch-clase_2.html">previous</a> ]
[ <a href="index.html#contents">Contents</a> ]
[ <a href="ch-clase_1.html">1</a> ]
[ <a href="ch-clase_2.html">2</a> ]
[ 3 ]
[ <a href="ch-clase_4.html">4</a> ]
[ <a href="ch-clase_7.html">5</a> ]
[ <a href="ch-clase_5.html">6</a> ]
[ <a href="ch-clase_6.html">7</a> ]
[ <a href="ch-clase_8.html">8</a> ]
[ <a href="ch-clase_9.html">9</a> ]
[ <a href="ch-clase_10.html">10</a> ]
[ <a href="ch-clase_11.html">11</a> ]
[ <a href="ch-clase_blaslap.html">12</a> ]
[ <a href="ch-cap_ref.html">13</a> ]
[ <a href="ch-clase_4.html">next</a> ]
</p>

<hr>

<p>
<code>Fortran 90</code> Lessons for Computational Chemistry
</p>

<address>
0.0<br>
<br>
Curro Pérez-Bernal <code><a href="mailto:francisco.perez@dfaie.uhu.es">mailto:francisco.perez@dfaie.uhu.es</a></code><br>
<br>
</address>
<hr>

</body>

</html>

